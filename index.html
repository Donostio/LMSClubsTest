<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Clubs</title>
  <link rel="icon" type="image/png" href="lms_logo.png">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LNV90DS36X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LNV90DS36X');
  </script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{--muted:#6b7280;--red:#ef4444;--black:#000;}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; -webkit-font-smoothing:antialiased;}
    body {background:#000;background-image: repeating-linear-gradient(to right, var(--red), var(--red) 2px, #000 2px, #000 24px);}
    .page {max-width:1180px;margin:28px auto;background:#fff;border-radius:12px;padding:18px;box-shadow:0 18px 60px rgba(0,0,0,0.20);}
    /* existing styles unchanged */
  </style>
</head>
<body>
  <!-- existing page content preserved -->
  <!-- ... -->
<script>
// inside createPrintHTML update only
function createPrintHTML(title, selectedArr, othersArr, options){
  options = options || {};
  const combined = (selectedArr || []).concat(othersArr || []);
  const { grid, days, whens } = buildGridForPrint(combined);
  const orientation = analyzeClubDensity(selectedArr || [], grid, days, whens);
  const catImages = ['images/11C.png','images/22C.png','images/33.png'];
  const randomCat = catImages[Math.floor(Math.random()*catImages.length)];

  const styles = `
    <style>
      @page { size:A4 ${orientation}; margin:12mm; orientation:${orientation}; }
      body{font-family:Inter,Arial,sans-serif;color:#000;margin:0;padding:12px;}
      table{width:100%;border-collapse:collapse;font-size:10pt;}
      th,td{border:1px solid #fff;padding:6px;vertical-align:top;}
      .table-top{border-top:2px solid #ccc!important;}
      .table-bottom{border-bottom:2px solid #ccc!important;}
      .row-divider td,.row-divider th{border-bottom:2px solid #ccc!important;}
      th{background:#f8fafc;text-align:left;font-weight:700;}
      .selected-box{border:2px solid #000;padding:6px;margin-bottom:6px;}
      .other-club{font-style:italic;color:#6b7280;font-size:90%;}
    </style>`;

  let html = `<!doctype html><html><head><meta charset="utf-8"><title>${esc(title)}</title>${styles}</head><body>`;
  html += `<table><thead><tr class="row-divider table-top"><th>When / Day</th>${days.map(d=>`<th>${d}</th>`).join('')}</tr></thead><tbody>`;

  whens.forEach((w,wi)=>{
    let rowClass="";
    if(wi===0) rowClass="row-divider"; // Before School
    if(wi===1) rowClass="row-divider"; // Lunchtime
    if(wi===whens.length-1) rowClass+=" table-bottom";
    html += `<tr class="${rowClass}">`;
    html += `<th>${w}</th>`;
    days.forEach(d=>{
      const cellClubs=grid[w][d]||[];
      let cellContent="";
      cellClubs.forEach(c=>{cellContent+=`<div class=\"selected-box\">${esc(c.name)}</div>`;});
      html += `<td>${cellContent||''}</td>`;
    });
    html += `</tr>`;
  });

  html += `</tbody></table></body></html>`;
  return html;
}
</script>
</body>
</html>


