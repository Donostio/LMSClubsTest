<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Clubs</title>
  <link rel="icon" type="image/png" href="lms_logo.png">
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LNV90DS36X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-LNV90DS36X');
  </script>
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{--muted:#6b7280;--red:#ef4444;--black:#000;}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; -webkit-font-smoothing:antialiased;}
    body {
      background:#000;
      background-image: repeating-linear-gradient(to right, var(--red), var(--red) 2px, #000 2px, #000 24px);
    }
    .page {max-width:1180px;margin:28px auto;background:#fff;border-radius:12px;padding:18px;box-shadow:0 18px 60px rgba(0,0,0,0.20);}
    header.top { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
    header.top h1 { margin:0; font-size:22px; font-weight:700; color:#111; }
    #year-filter {padding:10px;border-radius:10px;border:1px solid #e6e6e6;width:20%;min-width:84px;color:var(--red);font-weight:600;}
    #year-filter.filled { color:#111; }
    .print-controls { display:flex; align-items:center; gap:8px; margin-top:6px; }
    #search-input {padding:10px;border-radius:10px;border:1px solid #e6e6e6;width:20%;min-width:200px;}
    #clubs-list {display:grid;grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));gap:14px;margin-top:12px;}
    .club-card {position:relative;background:#fff;border:1px solid #e6e6e6;border-radius:12px;padding:14px;color:#111;transition: box-shadow .15s ease, transform .12s ease;min-height:120px;}
    .club-card:hover {transform:translateY(-4px);box-shadow:0 8px 28px rgba(0,0,0,0.06);}
    .muted {color:var(--muted);}
    .club-select-box {position:absolute;right:12px;bottom:12px;}
    .club-select-box input{display:none;} /* hidden until year selected */
    .club-select-box.show input{display:block;}
    .selected {box-shadow:0 0 0 3px rgba(0,0,0,1), 0 0 0 6px rgba(239,68,68,0.95);border:2px solid rgba(239,68,68,0.9);}
    /* Toast message styling */
    .toast-message {position:fixed;background:rgba(0,0,0,0.8);color:#fff;padding:12px 16px;border-radius:8px;font-size:14px;z-index:100;pointer-events:none;opacity:0;transition:opacity 0.3s ease;}
    .toast-message.show {opacity:1;}
    /* Consistent button widths */
    .print-button {width:180px;white-space:normal;text-align:center;}
    /* Deselect all button styling */
    .deselect-btn {position:relative;background:#fff;border:2px solid rgba(239,68,68,0.9);border-radius:12px;padding:14px;color:#111;cursor:pointer;min-width:160px;box-shadow:0 0 0 3px rgba(0,0,0,1), 0 0 0 6px rgba(239,68,68,0.95);transition: box-shadow .15s ease, transform .12s ease;}
    .deselect-btn:hover {transform:translateY(-2px);}
    .deselect-btn .tick-icon {position:absolute;right:12px;top:12px;width:20px;height:20px;}
    /* Filter panel club name input */
    .club-name-input {width:100%;padding:8px;border:1px solid #e6e6e6;border-radius:6px;font-size:13px;}
    .clear-club-name {margin-left:8px;font-size:12px;}
    .filter-overlay {display:none;position:fixed;inset:0;background:rgba(0,0,0,0.45);z-index:60;}
    .filter-panel {position:fixed;right:0;top:0;height:100%;width:360px;max-width:92%;background:#fff;z-index:70;transform:translateX(110%);transition:transform .28s cubic-bezier(.2,.9,.3,1);box-shadow:-20px 20px 60px rgba(0,0,0,0.12);padding:20px;overflow:auto;}
    .filter-panel h2, .filter-panel strong, .filter-panel label { color:#374151 !important; }
    .filter-panel label { color:#4b5563 !important; }
    .filter-panel.open {transform:translateX(0);}
    .clear-link {color:#7c3aed;cursor:pointer;font-size:13px;background:none;border:none;padding:0;}
    /* Cat animations */
    .cat-container {
      position: fixed;
      z-index: 100;
      pointer-events: none;
      will-change: transform;
    }
    /* Standard directional cats */
    .cat-container.from-top {
      top: 0;
      left: 50%;
      transform: translate(-50%, -100vh);
      transition: transform 0.8s ease-out;
    }
    .cat-container.from-top.is-active {
      transform: translate(-50%, 0);
    }
    .cat-container.from-right {
      top: 50%;
      right: 0;
      transform: translate(100vw, -50%);
      transition: transform 0.8s ease-out;
    }
    .cat-container.from-right.is-active {
      transform: translate(0, -50%);
    }
    .cat-container.from-bottom {
      bottom: 0;
      left: 50%;
      transform: translate(-50%, 100vh);
      transition: transform 0.8s ease-out;
    }
    .cat-container.from-bottom.is-active {
      transform: translate(-50%, 0);
    }
    .cat-container.from-left {
      top: 50%;
      left: 0;
      transform: translate(-100vw, -50%);
      transition: transform 0.8s ease-out;
    }
    .cat-container.from-left.is-active {
      transform: translate(0, -50%);
    }
    /* Ascending cat (large, vertical only) */
    .cat-container.ascending-cat {
      bottom: 0;
      left: 50%;
      transform: translate(-50%, 100%);
      transition: none;
    }
    .cat-container.ascending-cat.is-active {
      transform: translate(-50%, -66.6666%);
      transition: transform 3s ease-out;
    }
    .cat-container.ascending-cat.slide-down {
      transform: translate(-50%, 100%);
      transition: transform 0.5s ease-in;
    }
    /* Cat images */
    .cat-container img {
      width: 150px;
      height: auto;
      border-radius: 0.75rem;
    }
    .cat-container.ascending-cat img {
      transform: scale(7.5);
    }
    @media print {
      @page { orientation: landscape; margin:12mm; }
      body { background:#fff; }
      #filter-panel, #filter-btn, #search-input, .filter-overlay { display:none !important; }
      /* printable area visibility handled by generated print HTML */
    }
    @media (max-width:720px){ 
      #search-input, #year-filter { width:100%; } 
      .print-controls { flex-wrap:wrap; } 
      /* Fix mobile layout overlap issues */
      #active-filters-summary { 
        position: static !important; 
        transform: none !important; 
        margin-left: 0 !important; 
        margin-top: 8px; 
        font-size: 12px;
      }
      .search-filter-row { 
        flex-direction: column !important; 
        align-items: flex-start !important; 
        gap: 8px !important; 
      }
      /* Make buttons stack better on mobile - with !important to override global rules */
      .print-button { width: 100% !important; min-width: 140px !important; }
      #year-filter { min-width: 100px !important; }
    }
    /* Consistent widths for controls - moved before media query */
    #year-filter { min-width:160px; }
    .print-button { width:180px; }
    /* Filter summary repositioning */
    .search-filter-row { display:flex; align-items:flex-end; gap:12px; }
    #active-filters-summary { margin-left:12px; transform:translateY(-100%); }
  </style>
</head>
<body>
  ...
<script>
...
function createPrintHTML(title, selectedArr, othersArr, options){
  options = options || {};
  const combined = (selectedArr || []).concat(othersArr || []);
  const { grid, days, whens } = buildGridForPrint(combined);

  const orientation = analyzeClubDensity(selectedArr || [], grid, days, whens);
  const catImages = ['images/11C.png', 'images/22C.png', 'images/33.png'];
  const randomCat = catImages[Math.floor(Math.random() * catImages.length)];

  const styles = `
    <style>
      @page { size: A4 ${orientation}; margin: 12mm; orientation: ${orientation}; }
      body{ font-family: Inter, Arial, sans-serif; color:#000; margin:0; padding:12px; position: relative; }
      table{ width:100%; border-collapse:collapse; font-size:10pt; }
      th,td{ border:1px solid #fff; padding:6px; vertical-align:top; }
      .table-top    { border-top:2px solid #ccc !important; }
      .table-bottom { border-bottom:2px solid #ccc !important; }
      .row-divider td, .row-divider th { border-bottom:2px solid #ccc !important; }
      th{ background:#f8fafc; text-align:left; font-weight:700; }
      .selected-box{ border:2px solid #000; padding:6px; margin-bottom:6px; }
      .other-club{ font-style:italic; color:#6b7280; font-size:90%; }
    </style>`;

  let html = `<!doctype html><html><head><meta charset="utf-8"><title>${esc(title)}</title>${styles}</head><body>`;
  html += `<table><thead><tr class="row-divider table-top"><th>When / Day</th>${days.map(d=>`<th>${d}</th>`).join('')}</tr></thead><tbody>`;

  whens.forEach((w, wi) => {
    const rowClass = `row-divider${wi===0?' table-top':''}${wi===whens.length-1?' table-bottom':''}`;
    html += `<tr class="${rowClass}">`;
    html += `<th>${w}</th>`;
    days.forEach(d => {
      const cellClubs = grid[w][d] || [];
      let cellContent = '';
      cellClubs.forEach(c => { cellContent += `<div class="selected-box">${esc(c.name)}</div>`; });
      html += `<td>${cellContent || ''}</td>`;
    });
    html += `</tr>`;
  });

  html += `</tbody></table></body></html>`;
  return html;
}
</script>
</body>
</html>

